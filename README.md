# üåê –ü—Ä–æ–µ–∫—Ç: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
–û—Ä–∏–≥–∏–Ω–∞–ª—ã –¥–∞—Ç–∞—Å–µ—Ç–æ–≤: https://www.kaggle.com/datasets/rounakbanik/the-movies-dataset

---

# –ó–∞–ø—É—Å–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

## –í–∞—Ä–∏–∞–Ω—Ç 1. –ó–∞–ø—É—Å–∫ –≥–æ—Ç–æ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–∞ (—É—Ä–µ–∑–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ - —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –æ—Ç–∫–ª—é—á–∞—Ç—å—Å—è –∏–∑-–∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∑–∞–ø—É—Å–∫ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 5-10 –º–∏–Ω—É—Ç. 
–¢–∞–∫ –∂–µ –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞—Ç–∞—Å–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–µ–º–æ—Ü–µ–ª—è—Ö —É—Ä–µ–∑–∞–Ω, —á—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.
–î–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–æ–¥–±–æ—Ä–µ –ø–æ id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–µ id

–ì–æ—Ç–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤: https://huggingface.co/spaces/Saatarkin/rec   


## –í–∞—Ä–∏–∞–Ω—Ç 2. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

### 2.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å git
- –°–∫–∞—á–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
- –°–∫–∞—á–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä–∞, –º–æ–¥–µ–ª–∏ –∏ —Å–∞–º–∏ –¥–∞—Ç–∞—Å–µ—Ç—ã (–Ω—É–∂–Ω—ã –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –∫–∞—á–∞–µ—Ç—Å—è —Å GIT https://huggingface.co/datasets/Saatarkin/movies/blob/main/movies_rec_system.tar.gz)
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω—É–∂–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (pip install --no-cache-dir -r requirements.txt)
- –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥–æ–π streamlit run streamlit_app.py

### 2.2 Docker image
- –°–∫–∞—á–∞—Ç—å Docker images: saatarko/rec:latest (–æ–±—Ä–∞–∑ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–π, –ø—Ä–æ–±–æ—Ä–æ—Å –º–æ—Å—Ç–∞ –±—É–¥–µ—Ç –Ω–µ –æ—á–µ–Ω—å —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω—ã–º)
- –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–µ–±–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Docker images –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

---

## üß∞ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- DVC, Airflow, MLflow
- Scikit-learn (KMeans), Implicit ALS
- Autoencoder, PyTorch (RatingPredictor)

---

## –í–≤–µ–¥–µ–Ω–∏–µ
**–¶–µ–ª—å**: –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É, —Å–ø–æ—Å–æ–±–Ω—É—é –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/—Ñ–∏–ª—å–º–æ–≤.
---
## –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
1. **–•–æ–ª–æ–¥–Ω—ã–π —Å—Ç–∞—Ä—Ç**: —é–∑–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –∂–∞–Ω—Ä ‚Äî –≤—ã–¥–∞—ë–º top-5 –ø–æ popularity.
2. **–ú–∞–ª–æ –æ—Ü–µ–Ω–æ–∫**: –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤ ‚Äî –∏—â–µ–º –ø–æ—Ö–æ–∂–∏–µ (–∂–∞–Ω—Ä—ã + —Ç–µ–≥–∏ + relevance).
3. **–ú–∞–ª–æ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤**: <5 –æ—Ü–µ–Ω–æ–∫, –∏–ª–∏ >5, –Ω–æ <3 –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö.
4. **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**: >5 –æ—Ü–µ–Ω–æ–∫ ‚Äî –∫–ª–∞—Å—Ç–µ—Ä–∏–∑—É–µ–º user-–≤–µ–∫—Ç–æ—Ä.
5. **–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ/–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞**: —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—ã–¥–∞—á–∏.

---

## üîπ –ß–∞—Å—Ç—å 1: –ö–æ–Ω—Ç–µ–Ω—Ç-–±–∞–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å

1. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ —Ñ–∏–ª—å–º–æ–≤.
2. –°–æ–∑–¥–∞–Ω–∏–µ `movies_vector`:
   - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `scaler`)
   - –ü–æ–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ (`encoder`)
   - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (KMeans)
3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.
4. –û—Ñ—Ñ–ª–∞–π–Ω-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.
5. –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å–º–æ–≤ –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º—É —Ñ–ª–∞–≥—É.

---

## üî∏ –ß–∞—Å—Ç—å 2: –ì–∏–±—Ä–∏–¥ (ALS + –ö–æ–Ω—Ç–µ–Ω—Ç)

6. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.
7. –û–±—É—á–µ–Ω–∏–µ Implicit ALS ‚Üí `item_factors`.
8. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ñ–∏–ª—å–º–∞–º —Å —Ç–µ–≥–∞–º–∏.
9. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ `item_factors` + `movies_vector`.
10. –ü–æ–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ + –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (KMeans).  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
11. –û—Ñ—Ñ–ª–∞–π–Ω-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.
12. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å–º–∞:
    - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –¥–∞—Ç–∞—Å–µ—Ç—ã.
    - –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞.
    - –û–±—Ä–∞–±–æ—Ç–∫–∞ scaler ‚Üí encoder ‚Üí KMeans.

---

## üîπ –ß–∞—Å—Ç—å 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –º–æ–¥–µ–ª—å

13. –ü–æ–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.
14. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (KMeans).  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
15. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
    - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤.
    - –û–±—Ä–∞–±–æ—Ç–∫–∞ encoder ‚Üí KMeans.

---

## üî∏ –ß–∞—Å—Ç—å 4: RatingPredictor (–ù–µ–π—Ä–æ—Å–µ—Ç—å)

16. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:
    - –ó–∞–≥—Ä—É–∑–∫–∞ `ratings.csv`, `movies.csv`
    - –ö–æ–¥–∏—Ä–æ–≤–∫–∞ ID: `user_encoder.pkl`, `item_encoder.pkl`
    - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ CSR –º–∞—Ç—Ä–∏—Ü—ã: `ratings_csr.npz`

17. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤:
    - `user_content_vector.npz` (autoencoder)
    - `model_movies_full_vectors_raw.npz` (—Ç–µ–≥–∏)

18. –û–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ `RatingPredictor`:
    - –í—Ö–æ–¥: user-–≤–µ–∫—Ç–æ—Ä + item-–≤–µ–∫—Ç–æ—Ä
    - –í—ã—Ö–æ–¥: –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞
    - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ MLflow, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `neural_model_best.pt`

19. –§—É–Ω–∫—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ + –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤—ã–¥–∞—á–∏.

---
## üî∏ –ß–∞—Å—Ç—å 5: –£–ø—Ä–∞–≤–ª—è–µ–º–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è)

20. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:

‚úÖ –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ñ–∏–ª—å–º–∞–º:
- –ñ–∞–Ω—Ä—ã (One-Hot –∏–ª–∏ Multi-Hot Encoding) –∏  –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥

‚úÖ –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:
 - –ë–µ—Ä—ë–º —Ç–æ–ª—å–∫–æ –æ—Ü–µ–Ω–∫–∏ > 3.5 (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ)
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ—Å—Ç–∞–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å: –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ –∂–∞–Ω—Ä–∞–º, —Å—Ä–µ–¥–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º —Ñ–∏–ª—å–º–æ–≤,  –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–æ–∫ –ø–æ —Ç–∏–ø–∞–º —Ñ–∏–ª—å–º–æ–≤

21. –ü–æ–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏:
    - `user_segment_autoencoder` (autoencoder)
    - `encoded_user_vectors.npz` 

22. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è:
    - –†–∞—Å—á–µ—Ç –Ω—É–∂–Ω–æ–≥–æ –∫–æ–ª-–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ —Ä–∞–∑–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
    - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ MLflow

19. –§—É–Ω–∫—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ñ–∏–ª—å–º–∞–º
    - –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º


---
# üåê Project: Recommender system
Original datasets: https://www.kaggle.com/datasets/rounakbanik/the-movies-dataset

---

# Launching the recommender system

## Option 1. Launching a ready-made interactive (reduced functionality)
Warning - the server may shut down due to inactivity, in which case the initial launch may take 5-10 minutes.

Also, due to storage limitations, the user dataset in demo targets is truncated, which may cause errors in user-related queries.
To minimize errors when selecting by user ID, use small IDs

Ready-made interactive: https://huggingface.co/spaces/Saatarkin/rec

## Option 2. Local launch

### 2.1 Installation from git
- Download the project
- Download ready-made vectors, models and the datasets themselves (needed if the project is downloaded from GIT https://huggingface.co/datasets/Saatarkin/movies/blob/main/movies_rec_system.tar.gz)
- Install the necessary libraries (pip install --no-cache-dir -r requirements.txt)
- Run with the command streamlit run streamlit_app.py

### 2.2 Docker image
- Download Docker images: saatarko/rec:latest (the image is very large, breaking the bridge will not be very practical)
- Upload Docker images to your container and run the container

---

## üß∞ Technologies used
- DVC, Airflow, MLflow
- Scikit-learn (KMeans), Implicit ALS
- Autoencoder, PyTorch (RatingPredictor)

---

## Introduction
**Goal**: Build a recommender system that can handle cold start and dynamic user/movie addition scenarios.
---
## Main tasks
1. **Cold start**: user selects a genre ‚Äî output top-5 by popularity.
2. **Few ratings**: several watched movies ‚Äî search for similar ones (genres + tags + relevance).
3. **Few ratings**: <5 ratings, or >5, but <3 positive.
4. **Full recommendations**: >5 ratings ‚Äî cluster the user vector.
5. **Promotion/blocking**: filtering system at the search results level.

---

## üîπ Part 1: Content-based model

1. Calculating average popularity of movies.
2. Creating `movies_vector`:
- Feature normalization (saving `scaler`)
- Dimensionality reduction (`encoder`)
- Clustering (KMeans)
3. Implementing a cluster-based recommendation function.
4. Offline testing.
5. Promoting and filtering movies by a special flag.

---

## üî∏ Part 2: Hybrid (ALS + Content)

6. Forming an interaction matrix.
7. Training Implicit ALS ‚Üí `item_factors`.
8. Filtering by movies with tags.
9. Merging `item_factors` + `movies_vector`.
10. Dimensionality reduction + clustering (KMeans). Implementation of cluster-based recommendation function
11. Offline testing.
12. Dynamically adding movie:
- Adding to datasets.
- Vector construction.
- Scaler ‚Üí encoder ‚Üí KMeans processing.

---

## üîπ Part 3: User model

13. Interaction matrix dimensionality reduction.
14. User clustering (KMeans). Implementation of cluster-based recommendation function
15. Dynamically adding user:
- Adding ratings.
- Encoder ‚Üí KMeans processing.

---

## üî∏ Part 4: RatingPredictor (Neural Network)

16. Preparation:
- Loading `ratings.csv`, `movies.csv`
- ID encoding: `user_encoder.pkl`, `item_encoder.pkl`
- Forming CSR matrix: `ratings_csr.npz`

17. Building embeddings:
- `user_content_vector.npz` (autoencoder)
- `model_movies_full_vectors_raw.npz` (tags)

18. Training the `RatingPredictor` neural network:
- Input: user vector + item vector
- Output: rating prediction
- Logging in MLflow, saving `neural_model_best.pt`

19. Model recommendation function:
- Using embeddings + neural networks for personalized results.

---
## üî∏ Part 5: Supervised clustering (segmentation)

20. Preparation:

‚úÖ Segmentation by movies:
- Genres (One-Hot or Multi-Hot Encoding) and Average rating

‚úÖ Segmentation by users:
- We take only ratings > 3.5 (appropriate - this is a positive attitude)
- For each user, we create a profile: preferences by genres, average ratings by movie clusters, rating density by movie types

21. Dimensionality reduction:
- `user_segment_autoencoder` (autoencoder)
- `encoded_user_vectors.npz`

22. Clustering:
- Calculation of the required number of clusters using different methods
- Logging in MLflow

19. Recommendation function:
- Segmentation by movies
- Segmentation by users